# Chapter 11 파일 시스템

## 01 파일과 파일 시스템

* 파일 시스템
  - 파일을 보관/관리하는 파일 관리자를 두고 저장장치를 관리
  - 파일 관리자: 사용자 요청에 따라 파일을 저장하거나 읽어옴. 파일 테이블을 사용해 파일을 관리함
  - file descripter: 파일에 접근할 수 있는 권한(키) (파일 관리자로부터 획득)

* 파일 구조
  - sequential file structure
    - 파일 내용이 하나의 긴 줄로 늘어선 형태로 저장되어, 순차 접근만 가능한 구조
    - forward, backward를 이용한 sequential access로 원하는 위치로 접근할 수 있음
    - 장점: 낭비되는 공간이 없음. 구조가 단순. 순서대로 데이터 읽거나 저장할 때 매우 빠르게 처리됨
    - 단점: 새로운 데이터를 삽입, 삭제할 때 시간 많이 걸림. 데이터 검색이 어려움

  - index file structure
    - 순차 파일 구조에 인덱스 테이블을 추가해, 순차 접근과 직접 접근이 가능한 구조
    - ISAM(Index Sequential Access Method) 방식으로 접근 (인덱스 테이블에서 데이터 시작점을 통해 직접 접근)
    - 빠른 접근이 필요한 시스템에 사용

  - direct file structure
    - 저장하려는 데이터의 특정 값에 어떤 관계를 정의해, 물리적인 주소로 바로 변환하는 구조
    - hash function을 이용해 직접 접근이 가능
    - 데이터 접근이 매우 빠름
    - 해시 함수 선정이 중요함. 저장 공간이 낭비되는 문제도 있음


## 02 디렉터리의 구조

* directory
  - 관련 있는 파일을 하나로 모아놓은 곳. 하나의 디렉터리에는 여러 개의 파일과 sub directory(자식 디렉터리)가 존재
  - root directory: 최상위에 있는 디렉터리

* path
  - 파일이 전체 디렉터리 중 어디에 있는지를 나타내는 정보
  - absolute path: 루트 디렉터리를 기준으로 파일 위치를 표시
  - relative path: 현재 위치를 기준으로 파일 위치를 표시

* mount
  - 하나의 파일 테이블에 여러 개의 파티션을 붙여서 사용하는데, 여러 파티션을 통합하는 명령어 (un-mount로 분리도 가능)
  - 마운트를 사용하면 디렉터리를 이동할 때마다 다른 파티션에 넘어가도 사용자는 알지 못함
  - mounting point: 연결 지점

## 03 디스크 파일 할당

* 디스크 파일 할당 방식
  - contiguous allocation (연속 할당)
    - 파일을 구성하는 데이터를 디스크상에 연속적으로 배열하는 간단한 방식
  - non-contiguous allocation (불연속 할당)
    - 비어 있는 블록에 데이터를 분산하여 저장하고 파일 시스템이 관리하는 방식
    - linked allocation (연결 할당)
      - 파일에 속한 데이터를 연결 리스트로 관리하는 방식. 파일 테이블에 시작 블록의 정보만 저장 (ex. 윈도우의 FAT)
    - indexed allocation (인덱스 할당)
      - 데이터의 인덱스를 담고 있는 인덱스 블록끼리 연결하여 최대 할당 크기의 제약이 없는 방식 (ex, 유닉스의 I-node)

* 디스크의 빈 공간 관리: free block list
  - 디스크의 내부 단편화 줄이고 빈 공간 효율적으로 관리하기 위해 파일시스템은 빈 블록의 정보만 모아놓은 free block list를 유지
    - 디스크에 빈 블록 생기면 빈 공간 리스트에 추가
    - 빈 공간 리스트를 보고 새로운 블록 할당할 때는 먼저 들어온 블록부터 할당
